{
  "$schema": "../FZPF_v0.1.schema.json",
  "policy": {
    "format": "fzpf",
    "schema_version": "0.1",
    "policy_id": "comprehensive-example",
    "last_updated": "2026-01-16T12:00:00Z",
    "default_deny": true,
    "freshness_policy": "strict"
  },
  "defaults": {
    "taint": {
      "require_elevation_min_safety": "risky",
      "require_approval_min_safety": "dangerous"
    },
    "freshness": {
      "revocation_max_age_secs": 300,
      "checkpoint_max_age_secs": 300
    },
    "transport": {
      "allow_lan": true,
      "allow_derp": false,
      "allow_funnel": false
    }
  },
  "zones": [
    {
      "id": "z:owner",
      "name": "Owner Zone",
      "description": "Root trust anchor - owner keys only",
      "integrity_level": 100,
      "confidentiality_level": 100,
      "symbol_port": 9000,
      "control_port": 9001,
      "transport_policy": {
        "allow_lan": true,
        "allow_derp": false,
        "allow_funnel": false
      },
      "rekey_policy": {
        "epoch_ratchet_enabled": true,
        "overlap_secs": 30,
        "retain_epochs": 2,
        "rewrap_on_membership_change": true,
        "rotate_object_id_key_on_membership_change": true
      },
      "freshness_policy": "strict"
    },
    {
      "id": "z:private",
      "name": "Private Zone",
      "description": "Personal data and secrets",
      "integrity_level": 80,
      "confidentiality_level": 90,
      "parent": "z:owner",
      "symbol_port": 9010,
      "control_port": 9011,
      "transport_policy": {
        "allow_lan": true,
        "allow_derp": false,
        "allow_funnel": false
      },
      "rekey_policy": {
        "epoch_ratchet_enabled": true,
        "overlap_secs": 60,
        "retain_epochs": 3,
        "rewrap_on_membership_change": true,
        "rotate_object_id_key_on_membership_change": false
      },
      "freshness_policy": "strict"
    },
    {
      "id": "z:work",
      "name": "Work Zone",
      "description": "Work-related operations",
      "integrity_level": 60,
      "confidentiality_level": 70,
      "parent": "z:owner",
      "symbol_port": 9020,
      "control_port": 9021,
      "transport_policy": {
        "allow_lan": true,
        "allow_derp": true,
        "allow_funnel": false
      },
      "freshness_policy": "warn"
    },
    {
      "id": "z:community",
      "name": "Community Zone",
      "description": "Shared community resources",
      "integrity_level": 40,
      "confidentiality_level": 40,
      "symbol_port": 9030,
      "control_port": 9031,
      "transport_policy": {
        "allow_lan": true,
        "allow_derp": true,
        "allow_funnel": false
      },
      "freshness_policy": "warn"
    },
    {
      "id": "z:public",
      "name": "Public Zone",
      "description": "Public-facing services",
      "integrity_level": 20,
      "confidentiality_level": 10,
      "symbol_port": 9040,
      "control_port": 9041,
      "transport_policy": {
        "allow_lan": true,
        "allow_derp": true,
        "allow_funnel": true
      },
      "freshness_policy": "best_effort"
    }
  ],
  "zone_policies": [
    {
      "zone_id": "z:private",
      "principal_allow": ["owner:*", "agent:trusted-*"],
      "principal_deny": ["agent:untrusted-*"],
      "connector_allow": ["fcp.anthropic", "fcp.openai", "fcp.vectordb"],
      "decision_receipts": {
        "emit_on_allow": true,
        "emit_on_deny": true
      }
    },
    {
      "zone_id": "z:work",
      "principal_allow": ["owner:*", "agent:*"],
      "connector_allow": ["fcp.*"],
      "connector_deny": ["fcp.dangerous-*"],
      "capability_ceiling": ["data:read", "data:write", "api:invoke"]
    },
    {
      "zone_id": "z:public",
      "principal_allow": ["*"],
      "connector_allow": ["fcp.browser", "fcp.webhook-*"],
      "capability_deny": ["admin:*", "dangerous:*"]
    }
  ],
  "roles": [
    {
      "role_id": "viewer",
      "name": "Viewer",
      "description": "Read-only access",
      "caps": [
        { "capability_id": "data:read" }
      ]
    },
    {
      "role_id": "editor",
      "name": "Editor",
      "description": "Read and write access",
      "caps": [
        { "capability_id": "data:write" }
      ],
      "includes": ["viewer"]
    },
    {
      "role_id": "operator",
      "name": "Operator",
      "description": "Operational access including API calls",
      "caps": [
        { "capability_id": "api:invoke" },
        { "capability_id": "connector:configure" }
      ],
      "includes": ["editor"]
    },
    {
      "role_id": "admin",
      "name": "Administrator",
      "description": "Full administrative access",
      "caps": [
        { "capability_id": "admin:manage" },
        { "capability_id": "zone:configure" }
      ],
      "includes": ["operator"]
    }
  ],
  "role_assignments": [
    {
      "role_id": "viewer",
      "principal": "agent:readonly-agent",
      "zone_id": "z:public"
    },
    {
      "role_id": "editor",
      "principal": "agent:work-agent",
      "zone_id": "z:work"
    },
    {
      "role_id": "operator",
      "principal": "agent:ops-agent",
      "zone_id": "z:work",
      "attenuations": [
        {
          "capability_id": "api:invoke",
          "resource_allow": ["https://api.example.com/*"],
          "resource_deny": ["https://api.example.com/admin/*"]
        }
      ]
    },
    {
      "role_id": "admin",
      "principal": "owner:root",
      "zone_id": "z:owner"
    }
  ],
  "flows": [
    {
      "name": "owner-to-private",
      "from": "z:owner",
      "to": "z:private",
      "kind": "both",
      "allow": true,
      "audit": true
    },
    {
      "name": "private-to-work",
      "from": "z:private",
      "to": "z:work",
      "kind": "egress",
      "allow": true,
      "requires_declassification": true,
      "audit": true
    },
    {
      "name": "work-to-community",
      "from": "z:work",
      "to": "z:community",
      "kind": "egress",
      "allow": true,
      "requires_declassification": true,
      "audit": true
    },
    {
      "name": "community-to-public",
      "from": "z:community",
      "to": "z:public",
      "kind": "egress",
      "allow": true,
      "transform": "redact_pii",
      "audit": true
    },
    {
      "name": "public-ingress-to-community",
      "from": "z:public",
      "to": "z:community",
      "kind": "ingress",
      "allow": true,
      "requires_elevation": true,
      "audit": true
    },
    {
      "name": "public-to-private-deny",
      "from": "z:public",
      "to": "z:private",
      "kind": "ingress",
      "allow": false,
      "audit": true
    }
  ],
  "taint_rules": [
    {
      "name": "public-input-dangerous-deny",
      "min_safety": "dangerous",
      "taint_flags": ["public_input"],
      "action": {
        "type": "deny",
        "reason": "Public input cannot drive dangerous operations"
      }
    },
    {
      "name": "external-api-risky-elevation",
      "min_safety": "risky",
      "taint_flags": ["external_api"],
      "action": {
        "type": "require_elevation",
        "ttl_seconds": 300
      }
    },
    {
      "name": "pii-to-public-sanitize",
      "taint_flags": ["pii_present"],
      "target_zone_patterns": ["z:public", "z:community"],
      "action": {
        "type": "sanitize",
        "sanitizer": "pii-redactor"
      }
    }
  ],
  "approval_constraints": [
    {
      "name": "elevation-to-work",
      "scope_type": "elevation",
      "zone_id": "z:work",
      "target_integrity": 60,
      "max_ttl_seconds": 600
    },
    {
      "name": "declassification-private-to-work",
      "scope_type": "declassification",
      "from_zone": "z:private",
      "to_zone": "z:work",
      "target_confidentiality": 70,
      "max_ttl_seconds": 300,
      "require_request_binding": true
    },
    {
      "name": "execution-dangerous-ops",
      "scope_type": "execution",
      "zone_id": "z:work",
      "connector_pattern": "fcp.*",
      "method_pattern": "*.delete*",
      "max_ttl_seconds": 60,
      "require_request_binding": true,
      "require_input_hash": true
    }
  ]
}
